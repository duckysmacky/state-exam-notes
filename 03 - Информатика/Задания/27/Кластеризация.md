---
tags:
  - задание/тип
  - информатика/программирование
---
Новый прототип 2025го года

Есть какие то точки, которые можно отобразить на графике. Нам надо понять, где находится какой кластер (набор точек) и у каждого из них найти центроид.

## Понятия

### Кластер
*Это группа объектов, которые находятся в пределах определённой области и схожи по каким-то признакам*

- Каждый кластер имеет высоту `H` и ширину `W`
- В контексте задачи о звёздах кластером считается область, содержащая звёзды, расположенные близко друг к другу в рамках заданного прямоугольника

### Центроид
*Это центральная точка, которая характеризует данный кластер*

- В случае задачи о звёздах центроид выбирается среди самих звёзд, и для его нахождения вычисляется точка, от которой сумма расстояний до всех остальных звёзд кластера минимальна
- Одна из звезд на графике, сумма расстояний от которой до всех остальных звезд кластера минимальна
- Расстояние от точки до центроида - расстояние Евклида между точками $A(x_1, y_1)$ и $B(x_2, y_2)$ на плоскости

**Расстояние Евклида**: $d(A, b) = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}$

### Кластеризация
*Это метод машинного обучения, используемый для группировки данных в подмножества (кластеры), основываясь на схожести объектов внутри каждого кластера*

Основная цель кластеризации – разделить набор данных так, чтобы объекты внутри одного кластера были схожи, а между кластерами – максимально различались
В отличие от классификации, кластеризация относится к методам обучения без учителя, так как заранее не предполагается, что данные уже размечены (разделены на классы)

## Нахождение центроидов кластера

### Перебором
Переборный (тривиальный) алгоритм нахождения центроида кластера заключается в последовательной проверке каждой точки, чтобы найти ту, которая минимизирует сумму расстояний до остальных точек кластера

#### Алгоритм
1. Перебираются все точки и по очереди две попавшиеся выдаются за два центроида
2. Для каждого центроида рассчитывается сумма расстояний до всех остальных точек в кластере
3. Из всех точек выбирается та, у которой эта сумма минимальна — она и считается центроидом

Такой подход требует полного перебора всех точек и сравнений, что приводит к относительно высокой вычислительной сложности

### K-means
#### Алгоритм
1. Берем две случайные точки в качестве центроидов
2. Проходимся по каждой точке, находим к какой точке выбранный центроид более близкий, относим точку в группу, которая относится к одному из центроидов
3. Пересчитываем центроид для каждой группы - считаем среднее арифметическое значение всех точек в группе по `x` и `y` (k-центр)
4. Повторяем все шаги до того момента, как, после перечитывания координат центроида, они остаются такими же

Центроид в контексте k-means является просто образной точкой, которая имеет средние координаты кластера, в то время как в ЕГЭ центроид это какая то определенная точка

```python
def k_means(k_clusters: int, points: list, max_iterations: int = 10_000) -> list:
    centroids = [(?, ?), (?, ?), ...]
    for _ in range(max_iterations):
        clusters = [[] for _ in range(k_clusters)]
        for point in points:
            closest_i = min(range(k_clusters), key=lambda i: math.dist(point, centroids[i]))
            clusters[closest_i].append(point)
        new_centroids = []
        for cluster in clusters:
            avg_x = sum(x for x, y in cluster) / len(clusters)
            avg_y = sum(y for x, y in cluster) / len(clusters)
            new_centroids.append((avg_x,  avg_y))
        if centroids == new_centroids:
            break
        centroids = new_centroids[:]
    return centroids
```

## Конспекты
![[информатика 27 перебор кластеров.pdf]]